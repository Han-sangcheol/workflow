# 업무일지 AI 분석 시스템 프로젝트 규칙

## 0. 🌟 프로젝트 환경 (최우선)
- **가상환경 사용**: 본 프로젝트는 **반드시 가상환경**에서 실행됩니다.
- **패키지 관리**: uv를 사용하여 빠른 의존성 관리 (.venv 디렉토리)
- **테스트 실행**: pytest 실행 시 가상환경 활성화 필수
- **의존성 관리**: requirements.txt 기반, uv pip 명령 사용

## 1. 🚨 핵심 원칙 및 기술 스택 (최우선 준수)
# 시스템 아키텍처를 결정짓는 절대적 규칙입니다.
- **역할**: Python, PySide6 GUI 개발 및 AI 연동 전문가.
- **메인 프레임워크**: PySide6 (Qt for Python) 사용.
- **AI 연동**:
  - Ollama 로컬 API를 통해서만 AI 기능 수행 (직접 다른 AI API 사용 금지).
- **스레드 안전(Thread Safety)**:
  - UI 업데이트는 **무조건 메인 스레드**에서만 수행 (Signal-Slot 필수).
  - 공유 자원 접근 시 `threading.Lock`을 사용하여 동시성 문제(Race Condition) 방지.

## 2. 🏗️ 코드 구조 및 복잡도 (스파게티 코드 방지)
# AI가 긴 코드를 작성하다 길을 잃지 않게 하는 물리적 제약입니다.
- **파일 분리 기준**:
  - 파일 하나가 **300줄**을 초과하면 즉시 모듈 분리(Refactoring)를 제안하십시오.
  - 하나의 파일은 하나의 역할(SRP)만 수행합니다.
- **복잡도 제한**:
  - **들여쓰기**: 3단계 초과 금지 (함수로 분리).
  - **함수 길이**: 50줄 이하 유지.
  - **인자 개수**: 4개 이하 유지.

## 3. 🛡️ 안전성 및 예외 처리 (성능/보안 통합)
# 안정적인 동작을 위한 방어적 프로그래밍 규칙입니다.
- **예외 처리**:
  - 모든 파일 I/O 및 AI API 호출은 `try-except`로 감싸고, 실패 시 사용자에게 명확한 오류 메시지 제공.
- **성능 및 안정성**:
  - **입력 검증**: 사용자가 선택한 파일 및 경로는 로직 수행 전 반드시 유효성 검사(Validation) 수행.
  - **타임아웃 설정**: AI API 호출 시 적절한 타임아웃 설정 (기본 120초).
- **테스트 전략**:
  - 주요 로직 수정 시 `pytest` 단위 테스트 작성을 우선하고, AI는 Mock 객체로 테스트하십시오.

## 4. 📝 코딩 스타일 및 UI 컨벤션
- **언어**: 주석과 설명은 **한국어** 사용.
- **네이밍**: `snake_case`(함수/변수), `PascalCase`(클래스), `UPPER_SNAKE_CASE`(상수).
- **UI 가이드**:
  - Signal-Slot 연결 시 `@Slot()` 데코레이터 사용.
  - 긴 작업은 QThread로 분리하여 UI 프리징 방지.
- **문서화**: 함수 상단에 `docstring`으로 기능과 인자를 명시.

## 5. 🧠 AI 행동 지침 (Context 관리)
- **주석 보존**: 기존 코드의 한글 주석을 임의로 삭제하지 마십시오.
- **작업 방식**: 코드를 수정하기 전, "어떤 파일을 수정하며 예상되는 사이드 이펙트는 무엇인지" 한 줄로 요약 후 진행하십시오.
- **불명확성 제거**: 요구사항이 모호하면 가정을 세우지 말고 질문하십시오.